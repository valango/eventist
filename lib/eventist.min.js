/*!
 Eventist: event emitter for modular designs
 */
!function(t){"use strict";function e(){return this instanceof e?(this._events={},this._depth=0,void(this._hook=null)):new e}var n="function",i="string",o="object",r=void 0,h="_eventistMark",s="_eventistOnce",u=Array.prototype.slice,f={},c=function(t,e){throw new TypeError("Eventist#"+e+": "+t+"!")},l=function(t,e,n,i){t!==typeof e&&(n=[n,"must","be",t].join(" "),c(n,i))},a=e.prototype;a.on=function(t,e){var o,h=this._events,s="on";return l(i,t,"event",s),l(n,e,"handler",s),(o=h[t])!==r?o.push(e):h[t]=[e],this},a.once=function(t,e){var o="once";l(i,t,"event",o),l(n,e,"handler",o);var r=this,u=function(){var n=e.apply(r,arguments);return r.off(t,u),n};return u[h]=f,u[s]=e,this.on(t,u)},a.off=function(t,e){var n,o,u,c=this._events;if(l(i,t,"event","off"),(n=c[t])!==r){if(e===!0)return delete c[t],this;for(o=n.length;--o>=0;)((u=n[o])===e||u[h]===f&&u[s]===e)&&(n.splice(o,1),n.length===(o=0)&&delete c[t])}return this},a.emit=function(){var t,e,n,i,o,h=r,s=this._hook;if(e=u.call(arguments),s&&s.call(this,e),i=e.shift(1),(t=this._events[i])!==r){t=t.slice(),n=this.execute.bind(this),o=t.length,this._depth+=1;try{do h=n(t[--o],e,i);while(h===r&&o>0)}catch(f){throw this._depth-=1,f}this._depth-=1}return h},a.send=function(t){var e=this,i=u.call(arguments);return n===typeof t?i.shift(1):t=null,setTimeout(function(){var n,o=null;try{n=e.emit.apply(e,i)}catch(r){if(!t)throw r;o=r}t&&t(o,n,i)},0),e},a.depth=function(){return this._depth},a.info=function(){var t,e={},n=this._events;for(t in n)e[t]=n[t].length;return e},a.hook=function(t){var e=this._hook;return t?(l(n,t,"callback","hook"),this._hook=t):this._hook=null,e},a.execute=function(t,e){return t.apply(this,e)},n===typeof define&&define.amd&&o===typeof define.amd?define(function(){return e}):o===typeof module&&module.exports?module.exports=e:(t=t||this,t.Eventist=e)}.call(this);