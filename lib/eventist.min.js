/*!
 Eventist: event emitter for modular designs
 */
!function(t){"use strict";function e(){return this instanceof e?(this._events={},this._depth=0,this._hook=null,void(this._reporter=null)):new e}var n="function",r="string",i="object",o=void 0,s="_eventistMark",h="_eventistOnce",u=Array.prototype.slice,f={},l=function(t,e){throw new TypeError("Eventist#"+e+": "+t+"!")},c=function(t,e,n,r){t!==typeof e&&(n=[n,"must","be",t].join(" "),l(n,r))},a=e.prototype;a.on=function(t,e){var i,s=this._events,h="on";return c(r,t,"event",h),c(n,e,"handler",h),(i=s[t])!==o?i.push(e):s[t]=[e],this},a.once=function(t,e){var i="once";c(r,t,"event",i),c(n,e,"handler",i);var o=this,u=function(){var n=e.apply(o,arguments);return o.off(t,u),n};return u[s]=f,u[h]=e,this.on(t,u)},a.off=function(t,e){var n,i,u,l=this._events;if(c(r,t,"event","off"),(n=l[t])!==o){if(e===!0)return delete l[t],this;for(i=n.length;--i>=0;)((u=n[i])===e||u[s]===f&&u[h]===e)&&(n.splice(i,1),n.length===(i=0)&&delete l[t])}return this},a.emit=function(){var t,e,n,r,i,s=o,h=this._reporter,f=0,l=this._hook;if(e=u.call(arguments),l&&l.call(this,e),r=e.shift(1),(t=this._events[r])!==o){t=t.slice(),n=this.execute.bind(this),i=t.length,this._depth+=1;try{do f+=1,s=n(t[--i],e,r);while(s===o&&i>0)}catch(c){throw this._depth-=1,c}this._depth-=1}return h&&h(r,f,e),s},a.send=function(t){var e=this,i=u.call(arguments);n===typeof t?i.shift(1):t=null,c(r,i[0],"event","send");var o=function(t,n){return function(){var r,i=null;try{r=e.emit.apply(e,t)}catch(o){if(i=o,!n)throw o.hasOwnProperty("message")||(i=new Error(o+"")),i.message='Sending "'+t[0]+'": '+i.message,i}finally{n&&n(i,r,t)}}}(i,t);return setTimeout(o,0),e},a.depth=function(){return this._depth},a.info=function(){var t,e={},n=this._events;for(t in n)e[t]=n[t].length;return e},a.hook=function(t){var e=this._hook;return t?(c(n,t,"callback","hook"),this._hook=t):this._hook=null,e},a.reporter=function(t){var e=this._reporter;return t?(c(n,t,"callback","reporter"),this._reporter=t):this._reporter=null,e},a.execute=function(t,e){return t.apply(this,e)},n===typeof define&&define.amd&&i===typeof define.amd?define(function(){return e}):i===typeof module&&module.exports?module.exports=e:(t=t||this,t.Eventist=e)}.call(this);