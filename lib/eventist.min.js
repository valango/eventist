/*!
 Eventist: event emitter for modular designs.
 */
!function(t){"use strict";function e(){return this instanceof e?(this._events={},void(this._depth=0)):new e}var n="function",i="string",r="object",o=void 0,s="_eventistMark",h="_eventistOnce",u=Array.prototype.slice,f={},c=function(t,e){throw new TypeError("Eventist#"+e+": "+t+"!")},a=function(t,e,n,i){t!==typeof e&&(n=[n,"must","be",t].join(" "),c(n,i))},l=e.prototype;l.on=function(t,e){var r,s=this._events,h="on";return a(i,t,"event",h),a(n,e,"handler",h),(r=s[t])!==o?r.push(e):s[t]=[e],this},l.once=function(t,e){var r="once";a(i,t,"event",r),a(n,e,"handler",r);var o=this,u=function(){var n=e.apply(o,arguments);return o.off(t,u),n};return u[s]=f,u[h]=e,this.on(t,u)},l.off=function(t,e){var n,r,u,c=this._events;if(a(i,t,"event","off"),(n=c[t])!==o){if(e===!0)return delete c[t],this;for(r=n.length;--r>=0;)((u=n[r])===e||u[s]===f&&u[h]===e)&&(n.splice(r,1),n.length===(r=0)&&delete c[t])}return this},l.emit=function(t){var e,n,i,r,s=o;if(n=u.call(arguments),n.shift(1),(e=this._events[t])!==o){e=e.slice(),i=this.execute.bind(this),r=e.length,this._depth+=1;try{do s=i(e[--r],n,t);while(s===o&&r>0)}catch(h){throw this._depth-=1,h}this._depth-=1}return s},l.send=function(t){var e=this,i=u.call(arguments);return n===typeof t?i.shift(1):t=null,setTimeout(function(){var n,r=null;try{n=e.emit.apply(e,i)}catch(o){if(!t)throw o;r=o}t&&t(r,n,i)},0),e},l.depth=function(){return this._depth},l.info=function(){var t,e={},n=this._events;for(t in n)e[t]=n[t].length;return e},l.execute=function(t,e){return t.apply(this,e)},n===typeof define&&define.amd&&r===typeof define.amd?define(function(){return e}):r===typeof module&&module.exports?module.exports=e:(t=t||this,t.Eventist=e)}.call(this);